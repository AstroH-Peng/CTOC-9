function drv = modelJ2(t,rv)
%==========================================================================
%   李林澄   lilincheng2012@163.com      2017-09-10
%==========================================================================
% 功能：描述考虑J2摄动的轨道动力学方程，用于积分调用
% 输入： 
%      time           当前时刻
%      rv             当前位置速度，单位：km, km/s
% 输出：
%      drv            当前时刻位置和速度的微分，单位：km, km/s 
%==========================================================================

mu   = 398600;    %地球引力常数 km2/s2
J2   = 0.0010826; %J2摄动常数
Re   = 6378.137;  %地球半径 km

drv = zeros(6,1);                       
r   = sqrt(rv(1)^2 + rv(2)^2 + rv(3)^2);

drv  =  [ rv(4);
          rv(5);
          rv(6);
          -mu * rv(1) / r^3 * (1 + 3 / 2 * J2 * (Re / r)^2 * (1 - 5 * rv(3)^2 / r^2));
          -mu * rv(2) / r^3 * (1 + 3 / 2 * J2 * (Re / r)^2 * (1 - 5 * rv(3)^2 / r^2));
          -mu * rv(3) / r^3 * (1 + 3 / 2 * J2 * (Re / r)^2 * (3 - 5 * rv(3)^2 / r^2))  ];
end